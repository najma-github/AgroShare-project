<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <title> Reserve Surprise Bag - Fruitful Delights | AgroShare </title>
  <meta content="" name="description">
  <meta content="" name="keywords">

  <!-- Favicons -->
  <link href="assets/img/favicon.png" rel="icon">
  <link href="assets/img/apple-touch-icon.png" rel="apple-touch-icon">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600&family=Raleway:wght@600;800&display=swap"
    rel="stylesheet">

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com" rel="preconnect">
  <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;0,800;1,300;1,400;1,500;1,600;1,700;1,800&family=Marcellus:wght@400&display=swap"
    rel="stylesheet">

  <!-- Icon Font Stylesheet -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css" rel="stylesheet">

  <!-- Libraries Stylesheet -->
  <link href="lib/lightbox/css/lightbox.min.css" rel="stylesheet">
  <link href="lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet">

  <!-- Customized Bootstrap Stylesheet -->
  <link href="css/bootstrap.min.css" rel="stylesheet">

  <!-- Vendor CSS Files -->
  <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
  <link href="assets/vendor/aos/aos.css" rel="stylesheet">
  <link href="assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">
  <link href="assets/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">

  <!-- Main CSS File -->
  <link href="assets/css/main.css" rel="stylesheet">
  <link href="assets/css/style.css" rel="stylesheet">

  <!-- Bootstrap JS Bundle (includes Popper) -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

  <style>
    /* Style for the custom close button */
    .btn-close-custom {
      position: absolute;
      top: 10px;
      right: 10px;
      background-color: #f0f0f0;
      /* Light background color */
      border: none;
      border-radius: 50%;
      /* Circle shape */
      width: 30px;
      height: 30px;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 0;
    }

    .btn-close-custom::before {
      content: '×';
      /* Cross mark */
      font-size: 20px;
      color: #333;
      /* Dark color for the cross mark */
      line-height: 1;
    }

    .modal-content {
      position: relative;
    }

    .modal-body {
      padding: 20px;
    }
  </style>

</head>

<body>
  <header id="header" class="header d-flex align-items-center position-relative">
    <div class="container-fluid container-xl position-relative d-flex align-items-center justify-content-between">

      <a href="index.html" class="logo d-flex align-items-center">
        <!-- Uncomment the line below if you also wish to use an image logo -->
        <img src="assets/img/logo.png" alt="AgriCulture">
        <!-- <h1 class="sitename">AgriCulture</h1>  -->
      </a>

      <nav id="navmenu" class="navmenu">
        <ul>
          <li><a href="index.html" class="active">Home</a></li>
          <!-- <li><a href="Products.html">Products</a></li> -->
          <li><a href="blog.html">Blog</a></li>
          </li>
          <li><a href="contact.html">Contact</a></li>
        </ul>
        <i class="mobile-nav-toggle d-xl-none bi bi-list"></i>
      </nav>

    </div>
  </header>

  <!-- Page Title -->
  <div class="page-title dark-background" data-aos="fade" style="background-image: url(assets/img/page-title-bg.webp);">
    <div class="container position-relative">
    </div>
  </div><!-- End Page Title -->


  <!-- Single Product Start -->
  <form id="reservationForm">
    <div class="container-fluid py-5 mt-5">
      <div class="container py-5">
        <div class="row g-4 mb-5">
          <div class="col-lg-8 col-xl-9">
            <!-- <div class="row g-4">
              <div class="col-lg-6">
                <div class="border rounded">
                  <a href="#">
                    <img src="img/fruitful-delights.jpeg" class="img-fluid rounded" alt="Image">
                  </a>
                </div>
              </div>
              <div class="col-lg-6 pt-5 pb-5">
                <h4 class="fw-bold mb-3">Fruitful Delights</h4>
                <p class="mb-3" style="font-weight: bold;">Category: Fruits</p>
                <div class="productDescription">
                  <p>Experience a taste sensation with our Flavorful Fruit Basket! Overflowing with an assortment of
                    mouthwatering fresh fruits and complemented by delicious cookies, this gift is a true delight for
                    the
                    senses. Whether it's a celebration or a thoughtful gesture, this scrumptious combination is sure to
                    bring joy and satisfaction.</p>
                  <p><strong>Items Included:</strong><br>• Watermelon Large - 01<br>• Pineapple - 01<br>• Mandarin
                    250G<br>• Alphonso Mango 1kg / Cantaloupe Melon 01<br>• Passion Fruit 500g<br>• Guava 500g<br>•
                    Green
                    Grapes 250g<br><br></p>

                </div>
              </div>
            </div> -->
            <div id="productSection" class="row g-4">
              <!-- Product details will be dynamically inserted here -->
            </div>

          </div>
        </div>
        <div class="row">
          <div class="col-12">
            <h5 class="text-center fw-bold">Are You Satisfied With the Products Listed?</h5>
          </div>
        </div>
        <div class="container mt-5">

          <div class="row justify-content-center mt-4">
            <div class="col-md-3 mb-3">
              <label for="date" class="form-label">Choose Date</label>
              <input type="date" class="form-control" id="date" name="date" required>
            </div>
            <div class="col-md-3 mb-3">
              <label for="time" class="form-label">Choose Time</label>
              <select class="form-control" id="time" name="time" required>
                <option value="" disabled selected hidden>Select a time</option>
                <option value="9-11AM">9 AM - 11 AM</option>
                <option value="1-3PM">1 PM - 3 PM</option>
                <option value="5-7PM">5 PM - 7 PM</option>
              </select>
            </div>
            <div class="col-md-3 mb-3">
              <label for="phone" class="form-label">Phone Number</label>
              <input type="tel" class="form-control" id="phone" name="phone" placeholder="Enter your phone number"
                pattern="\d{3}-\d{3}-\d{4}" title="Please match the requested format: 012-345-6789" required>
            </div>
          </div>

        </div>
        <!-- Reserve Button Start -->
        <div class="row justify-content-center mt-4">
          <div class="col-md-3 text-center">
            <button type="submit" data-bs-toggle="modal" class="btn-reserve" id="Reserve">Reserve</button>
          </div>
        </div>
        <!-- Reserve Button End -->
      </div>
    </div>
  </form>
  <!-- Footer Start -->
  <footer id="footer" class="footer dark-background">

    <div class="footer-top">
      <div class="container">
        <div class="row gy-4">
          <div class="col-lg-4 col-md-6 footer-about">
            <a href="index.html" class="logo d-flex align-items-center">
              <span class="sitename">AgroShare</span>
            </a>
            <div class="footer-contact pt-3">
              <p>A108 Adam Street</p>
              <p>New York, NY 535022</p>
              <p class="mt-3"><strong>Phone:</strong> <span>+1 5589 55488 55</span></p>
              <p><strong>Email:</strong> <span>info@example.com</span></p>
            </div>
          </div>

          <div class="col-lg-2 col-md-3 footer-links">
            <h4>Useful Links</h4>
            <ul>
              <li><a href="#">Home</a></li>
              <li><a href="#">Products</a></li>
              #<li><a href="#">Services</a></li>
              <li><a href="#">Terms of service</a></li>
              <li><a href="#">Privacy policy</a></li>
            </ul>
          </div>

          <div class="col-lg-2 col-md-3 footer-links">
            <h4>Our Services</h4>
            <ul>
              <li><a href="#">Web Design</a></li>
              <li><a href="#">Web Development</a></li>
              <li><a href="#">Product Management</a></li>
              <li><a href="#">Marketing</a></li>
              <li><a href="#">Graphic Design</a></li>
            </ul>
          </div>

          <div class="col-lg-2 col-md-3 footer-links">
            <h4>Hic solutasetp</h4>
            <ul>
              <li><a href="#">Molestiae accusamus iure</a></li>
              <li><a href="#">Excepturi dignissimos</a></li>
              <li><a href="#">Suscipit distinctio</a></li>
              <li><a href="#">Dilecta</a></li>
              <li><a href="#">Sit quas consectetur</a></li>
            </ul>
          </div>

          <div class="col-lg-2 col-md-3 footer-links">
            <h4>Nobis illum</h4>
            <ul>
              <li><a href="#">Ipsam</a></li>
              <li><a href="#">Laudantium dolorum</a></li>
              <li><a href="#">Dinera</a></li>
              <li><a href="#">Trodelas</a></li>
              <li><a href="#">Flexo</a></li>
            </ul>
          </div>

        </div>
      </div>
    </div>

    <div class="copyright text-center">
      <div
        class="container d-flex flex-column flex-lg-row justify-content-center justify-content-lg-between align-items-center">

        <div class="d-flex flex-column align-items-center align-items-lg-start">
          <div>
            © Copyright <strong><span>MyWebsite</span></strong>. All Rights Reserved
          </div>
          <div class="credits">

            Designed by <a href="https://bootstrapmade.com/">Najma Dhasthakeer</a>
          </div>
        </div>

        <div class="social-links order-first order-lg-last mb-3 mb-lg-0">
          <a href=""><i class="bi bi-twitter-x"></i></a>
          <a href=""><i class="bi bi-facebook"></i></a>
          <a href=""><i class="bi bi-instagram"></i></a>
          <a href=""><i class="bi bi-linkedin"></i></a>
        </div>

      </div>
    </div>

  </footer>

  <!-- Scroll Top -->
  <a href="#" id="scroll-top" class="scroll-top d-flex align-items-center justify-content-center"><i
      class="bi bi-arrow-up-short"></i></a>

  <!-- Preloader -->
  <div id="preloader"></div>

  <!-- Vendor JS Files -->
  <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="assets/vendor/php-email-form/validate.js"></script>
  <script src="assets/vendor/aos/aos.js"></script>
  <script src="assets/vendor/swiper/swiper-bundle.min.js"></script>
  <script src="assets/vendor/glightbox/js/glightbox.min.js"></script>

  <!-- Main JS File -->
  <script src="assets/js/main.js"></script>

  <!-- JavaScript Libraries -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="lib/easing/easing.min.js"></script>
  <script src="lib/waypoints/waypoints.min.js"></script>
  <script src="lib/lightbox/js/lightbox.min.js"></script>
  <script src="lib/owlcarousel/owl.carousel.min.js"></script>

  <!-- Template Javascript -->
  <script src="js/main.js"></script>

  <!-- Modal Structure -->
  <div class="modal fade" id="thankYouModal" tabindex="-1" aria-labelledby="thankYouModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-body text-center">
          <h5 class="modal-title" id="thankYouModalLabel">Thank You!</h5>
          <p>You Just Saved a Meal</p>
          <p>Your Reservation Number: <span id="reservationNumber"></span></p>
          <a id="downloadLink" href="#" download="reservation.png" class="btn btn-primary mt-3">Download</a>
          <button type="button" class="btn btn-close-custom" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
      </div>
    </div>

    <!-- JavaScript to Generate Reservation Number, Handle Form Submission, and Download File -->
    <script>
      // Function to generate a random 11-digit number
      function generateReservationNumber() {
        return Math.floor(10000000000 + Math.random() * 90000000000);
      }

      // Function to update the reservation number and prepare the PNG image for download
      function updateReservationNumber() {
        const reservationNumber = generateReservationNumber();
        document.getElementById('reservationNumber').textContent = reservationNumber;

        // Create file content as text
        const text = `Thank You!\nYou Just Saved a Meal\n\nYour Reservation Number: ${reservationNumber}`;

        // Create a canvas element
        const canvas = document.createElement('canvas');
        const context = canvas.getContext('2d');

        // Set canvas size
        canvas.width = 1080;
        canvas.height = 1080;

        // Fill canvas background with white color
        context.fillStyle = 'white';

        // Set font properties
        context.font = '10px Arial';
        context.fillStyle = 'dark';
        context.textAlign = 'center';

        // Draw text on canvas
        context.fillText(text, canvas.width / 2, canvas.height / 2);

        // Convert canvas to PNG
        const imageUrl = canvas.toDataURL('image/png');

        // Create a Blob from the image URL
        const blob = dataURLtoBlob(imageUrl);
        const url = URL.createObjectURL(blob);

        // Update download link
        const downloadLink = document.getElementById('downloadLink');
        downloadLink.href = url;
        downloadLink.download = 'reservation.png'; // Name of the downloaded file
      }

      // Helper function to convert dataURL to Blob
      function dataURLtoBlob(dataURL) {
        const [header, data] = dataURL.split(',');
        const mimeString = header.split(':')[1].split(';')[0];
        const byteString = atob(data);
        const arrayBuffer = new ArrayBuffer(byteString.length);
        const uint8Array = new Uint8Array(arrayBuffer);
        for (let i = 0; i < byteString.length; i++) {
          uint8Array[i] = byteString.charCodeAt(i);
        }
        return new Blob([arrayBuffer], { type: mimeString });
      }

      // Add event listener to update reservation number when the modal is about to be shown
      // document.getElementById('thankYouModal').addEventListener('show.bs.modal', updateReservationNumber);

      // Handle form submission
      // document.getElementById('reservationForm').addEventListener('submit', function (event) {
      //   // Prevent form from submitting if validation fails
      //   if (!this.checkValidity()) {
      //     event.preventDefault(); // Prevent the form from submitting
      //     event.stopPropagation(); // Stop further event propagation
      //   } else {
      //     // If the form is valid, show the modal
      //     var modalInstance = new bootstrap.Modal(document.getElementById('thankYouModal'));
      //     modalInstance.show();
      //   }

      //   this.classList.add('was-validated'); // Add validation feedback
      // }, false);

    </script>

    <!-- JavaScript to Generate Reservation Number, Handle Form Submission, and Download File -->
    <script type="module">
      // Declare global variables
      let globalReservationNumber = '';

      // Function to generate a reservation number
      function generateReservationNumber() {
        return Math.floor(10000000000 + Math.random() * 90000000000);
      }

      // Function to update reservation number and generate image
      function updateReservationNumber() {
        const reservationNumber = globalReservationNumber;
        document.getElementById('reservationNumber').textContent = reservationNumber;

        const text = `Thank You!\n\nYour Reservation Number: ${reservationNumber}`;
        const canvas = document.createElement('canvas');
        const context = canvas.getContext('2d');
        canvas.width = 1920;
        canvas.height = 1080;
        context.fillStyle = 'white';
        context.fillRect(0, 0, canvas.width, canvas.height);
        context.font = '40px Arial';
        context.fillStyle = 'black';
        context.textAlign = 'center';
        context.textBaseline = 'middle';
        context.fillText(text, canvas.width / 2, canvas.height / 2);

        const imageUrl = canvas.toDataURL('image/png');
        const blob = dataURLtoBlob(imageUrl);
        const url = URL.createObjectURL(blob);

        const downloadLink = document.getElementById('downloadLink');
        downloadLink.href = url;
        downloadLink.download = 'reservation.png';

        // Redirect when the modal is hidden
        const modalElement = document.getElementById('thankYouModal');
        modalElement.addEventListener('hidden.bs.modal', function () {
          window.location.href = 'product-view.html';
        });
      }

      // Convert data URL to Blob
      function dataURLtoBlob(dataURL) {
        const [header, data] = dataURL.split(',');
        const mimeString = header.split(':')[1].split(';')[0];
        const byteString = atob(data);
        const arrayBuffer = new ArrayBuffer(byteString.length);
        const uint8Array = new Uint8Array(arrayBuffer);
        for (let i = 0; i < byteString.length; i++) {
          uint8Array[i] = byteString.charCodeAt(i);
        }
        return new Blob([arrayBuffer], { type: mimeString });
      }

      // Import Firebase modules
      import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-app.js";
      import { getDatabase, ref, set, get } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-database.js";

      const firebaseConfig = {
        apiKey: "AIzaSyB-z9SNypbmpCfY3yzrVyaFJnAVZnCJ5IE",
        authDomain: "agroshare-project.firebaseapp.com",
        databaseURL: "https://agroshare-project-default-rtdb.firebaseio.com",
        projectId: "agroshare-project",
        storageBucket: "agroshare-project.appspot.com",
        messagingSenderId: "444750909875",
        appId: "1:444750909875:web:68372fafa9a6f77433bbc6",
        measurementId: "G-WBVY2TF663"
      };

      const app = initializeApp(firebaseConfig);
      const db = getDatabase(app);

      // Handle form submission
      document.getElementById('reservationForm').addEventListener('submit', function (event) {
        event.preventDefault();

        console.log("reservationForm form submitted!");

        let date = document.getElementById('date').value;
        let time = document.getElementById('time').value;
        let phone = document.getElementById('phone').value;
        let reservationForm = document.getElementById('reservationForm');

        if (date === "" || time === "" || phone === "") {
          alert("Please fill out all fields.");
          return;
        }

        globalReservationNumber = 'OrderID_' + Date.now();

        set(ref(db, 'ReservationDetails/' + globalReservationNumber), {
          date: date,
          time: time,
          phone: phone,
          OrderID: globalReservationNumber,
        }).then(() => {
          var modalInstance = new bootstrap.Modal(document.getElementById('thankYouModal'));
          modalInstance.show();
          console.log("reservationForm form submitted!");
          reservationForm.reset(); // Reset the form after successful submission
        }).catch((error) => {
          console.log("Error during submission: ", error);
        });
      });

      document.getElementById('thankYouModal').addEventListener('show.bs.modal', updateReservationNumber);

      // Function to load product details from Firebase
      function loadProductDetails() {
        const productID = 'ProductID_1722783516258'; // Replace with dynamic ID if needed
        const productRef = ref(db, 'Product_details/' + productID);

        get(productRef).then((snapshot) => {
          if (snapshot.exists()) {
            const productData = snapshot.val();
            const productSection = document.getElementById('productSection');
            productSection.innerHTML = `
        <div class="row">
          <div class="col-lg-6">
            <div class="border rounded">
              <a href="#">
                <img src="${productData.productImageUrl}" class="img-fluid rounded" alt="${productData.productName}">
              </a>
            </div>
          </div>
          <div class="col-lg-6 pt-5 pb-5">
            <h4 class="fw-bold mb-3">${productData.productName}</h4>
            <p class="mb-3" style="font-weight: bold;">Category: ${productData.productType}</p>
            <div class="productDescription">
              <p>${productData.productdescription}</p>
              <p><strong>Items Included:</strong><br>${productData.itemsIncluded}</p>
            </div>
          </div>
        </div>
      `;
          } else {
            console.log("No data available");
            // Optional: Display a message if no data is found
            const productSection = document.getElementById('productSection');
            productSection.innerHTML = `<p>No product details available.</p>`;
          }
        }).catch((error) => {
          console.error("Error fetching product details: ", error);
        });
      }

      // Call the function to load product details
      loadProductDetails();


      // Call the function to load product details
      loadProductDetails();
    </script>






</body>

</html>